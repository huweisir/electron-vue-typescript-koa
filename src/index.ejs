<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>electron-vue</title>
  <% if (htmlWebpackPlugin.options.nodeModules) { %>
  <!-- Add `node_modules/` to global paths so `require` works properly in development -->
  <script type="text/javascript" src="https://i.epay.126.net/a/eyq/wap/20160216/js/public/sea.js?201904161425"></script>
  <script type="text/javascript" src="https://nos.netease.com/apmsdk/napm-web-min-1.1.5.js"></script>
  <script type="text/javascript" src="https://i.epay.126.net/a/eyq/payment/20151121/js/module/sha256.js"></script>
  <script type="text/javascript">
    // s
    var sha256 = module.exports.sha256;
    var sha224 = module.exports.sha224;
  </script>
  <script>
    var env = 'prod'
    if (env === 'prod') {
      /**
       * netease hubble statistics
       */
      (function (h, a) {
        if (!a.__SV) {
          var b = window;
          try {
            var c, l, i, j = b.location,
              e = j.hash;
            c = function (a, b) {
              return (l = a.match(RegExp(b + "=([^&]*)"))) ? l[1] : null
            };
            e && c(e, "state") && (i = JSON.parse(decodeURIComponent(c(e, "state"))), "mpeditor" === i.action && (b
              .sessionStorage.setItem("_mpcehash", e), history.replaceState(i.desiredHash || "", h.title, j
                .pathname + j.search)))
          } catch (m) {}
          var k, g;
          window.DATracker = a;
          a._i = [];
          a.init = function (b, c, f) {
            function e(b, a) {
              var c = a.split(".");
              2 == c.length && (b = b[c[0]], a = c[1]);
              b[a] = function () {
                b.push([a].concat(Array.prototype.slice.call(arguments,
                  0)))
              }
            }
            var d = a;
            "undefined" !== typeof f ? d = a[f] = [] : f = "DATracker";
            d.people = d.people || [];
            d.toString = function (b) {
              var a = "DATracker";
              "DATracker" !== f && (a += "." + f);
              b || (a += " (stub)");
              return a
            };
            d.people.toString = function () {
              return d.toString(1) + ".people (stub)"
            };
            k =
              "register_attributes register_attributes_once clear_attributes unregister_attributes current_attributes single_pageview disable time_event get_appStatus track set_userId track_pageview track_links track_forms register register_once alias unregister identify login logout signup name_tag set_config reset people.set people.set_once people.set_realname people.set_country people.set_province people.set_city people.set_age people.set_gender people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.set_populationWithAccount  people.set_location people.set_birthday people.set_region people.set_account"
              .split(" ");
            for (g = 0; g < k.length; g++) e(d, k[g]);
            a._i.push([b, c, f])
          };
          a.__SV = 1.2;
          b = h.createElement("script");
          b.type = "text/javascript";
          b.async = !0;
          b.src = "https://hubble-js-bucket.nosdn.127.net/DATracker.globals.1.2.2.js";
          c = h.getElementsByTagName("script")[0];
          c.parentNode.insertBefore(b, c)
        }
      })(document, window.DATracker || []);
      //初始化
      var params = {
        truncateLength: 255,
        persistence: 'localStorage',
        cross_subdomain_cookie: false
      }
      DATracker.init('MA-B9D6-269DF3E58055', params)
    }

    function hybird(command, params, fn) {
      params = params || {};
      if (window.NEJB && window.NEJB.invoke) {
        window.NEJB.invoke(command, fn, params)
      } else {
        document.addEventListener('NEJBReady', function () {
          window.NEJB.invoke(command, fn, params)
        })
      }
    }

    function HubbleUtil(category, label) {
      this.category = category
      this.label = label
      this.accid = sha256("yd.a4436a0f65b04d159@163.com")

      var self = this;
      if (/epay163SDK/.test(navigator.userAgent)) {
        hybird('getDeviceInfo', {}, function (info) {
          if (info) {
            var result = info['result']
            self.epaySDKVersion = result.sdkVersion // h5嵌入对象版本
            //self.deviceos = result.sysVersion // 手机系统版本
            //self.appversion = result.appVersion // 宿主版本
            //self.appchannel = result.appId // 宿主名称
          }
        })
      }
    }

    HubbleUtil.prototype.report = function (eventid, other) {
      var trackObj = {
        category: this.category,
        label: this.label,
        accid: this.accid,
        epaySDKVersion: this.epaySDKVersion || ''

      }
      if (other) {
        for (var i in other) {
          trackObj[i] = other[i]
        }
      }
      if (env === 'prod') {
        try {
          window.DATracker && window.DATracker.track(eventid, trackObj)
        } catch (e) {};
      } else {
        console.log('hubble上报信息：', eventid, ',', JSON.stringify(trackObj))
      }
    }

    // 哨兵接入
    var nssReport = {
      params: {
        clusterName: 'epay_web',
        deviceId: 'H5',
        modelName: 'epayWebModelNew',
        timestamp: +new Date(),
        dataList: [],
      },
      report: function (data) {
        if (!data) {
          return;
        }
        this.params.dataList.length = 0;
        if (typeof data === 'string') {
          this.params.dataList[0] = {};
          this.params.dataList[0].msg = data
        } else if (Object.prototype.toString.call(data) === '[object Object]') {
          this.params.dataList.push(data)
        } else if (Object.prototype.toString.call(data) === '[object Array]') {
          if (!data.length) {
            return;
          }
          this.params.dataList = data.slice(0)
        }
        var len = this.params.dataList.length
        for (var i = 0; i < len; i++) {
          this.params.dataList[i].url = this.params.dataList[i].url || location.href;
          this.params.dataList[i].ua = navigator.userAgent;
          this.params.dataList[i].errorCode = this.params.dataList[i].errorCode || 400;
          this.params.dataList[i].event = this.params.dataList[i].event || 'js错误检测';
          // this.params.dataList[i].levels = 1;
          // this.params.dataList[i].systemVersion = '';
        }
        this.params.timestamp = new Date().getTime();
        var params = JSON.stringify(this.params);
        $.ajax({
          url: 'https://pr.nss.netease.com/sentry/passive',
          method: 'post',
          async: false,
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          data: params,
          success: function (data) {},
          error: function () {}
        })
      }
    }
  </script>
  <script>
    require('module').globalPaths.push("<%= htmlWebpackPlugin.options.nodeModules.replace(/\\/g, '\\\\') %>")
    // const enav = new (require('electron-navigation'))();
    var mixpanel = require('mixpanel-browser');
    // var sha256 = require("https://i.epay.126.net/a/eyq/payment/20151121/js/module/sha256.js");
  </script>
  <% } %>
</head>

<body>
  <div id="app"></div>
  <!-- Set `__static` path to static files in production -->
  <% if (!process.browser) { %>
  <script>
    if (process.env.NODE_ENV !== 'development') window.__static = require('path').join(__dirname, '/static').replace(
      /\\/g, '\\\\')
  </script>
  <% } %>
  <!-- <script type="text/javascript" src="https://i.epay.126.net/a/eyq/wap/20160216/js/public/sea.js"></script> -->
  <!-- 网易易盾防作弊文件 ，会自动启请求https://acstatic-dun.126.net/watchman.min.js  -->
  <script type="text/javascript" src="https://hubble-js-bucket.nosdn.127.net/DATracker.globals.1.2.2.js"></script>
  <script type="text/javascript" src="https://acstatic-dun.126.net/tool.min.js"></script>
  <!-- webpack builds are automatically injected -->
</body>

</html>